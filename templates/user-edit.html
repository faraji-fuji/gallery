{% extends "layout.html" %}

{% block content %}

<div class="container-fluid tm-mt-60">
    <div class="row tm-mb-50">
        <div class="col-lg-12 col-12 mb-5">
            <h2 class="tm-text-primary mb-5">Setup Your Account</h2>
            <form id="user-edit-form" action="" method="POST" class="tm-contact-form mx-auto">
                <div class="form-group">
                    <input type="text" name="name" class="form-control rounded-0" placeholder="Name" required />
                </div>

                <div class="form-group">
                    <input type="text" name="default-gallery" class="form-control rounded-0" placeholder="Default Gallery Name" required />
                </div>

                <div class="form-group tm-text-right">
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>                
        </div>
    </div>
</div>


<script>
    $(document).ready(function() {
      // When the form is submitted
      $("#user-edit-form").submit(function(event) {
        event.preventDefault(); // Prevent the default form submission behavior
  
        // Get form data
        var formData = {
          name: $("input[name='name']").val(),
          default_gallery: $("input[name='default-gallery']").val()
        };
  
        // Perform PUT request using jQuery
        $.ajax({
          url: "/api/user/{{ data['user_id'] }}/",
          type: "PUT",
          data: formData,
          success: function(response) {
            // Handle success response
            console.log("Form submitted successfully");
            console.log(response);
            
            $.ajax({
          url: "/api/user/{{ data['user_id'] }}/",
          type: "PUT",
          data: formData,
          success: function(response) {
            // Handle success response
            console.log("Form submitted successfully");
            console.log(response);

            // Redirect to the index page on success
            window.location.href = "/";
          },
          error: function(error) {
            // Handle error response
            console.error("Form submission failed");
            console.error(error);
          }
        });
            // Redirect to the index page on success
            window.location.href = "/";
          },
          error: function(error) {
            // Handle error response
            console.error("Form submission failed");
            console.error(error);
          }
        });
      });
    });
  </script>
  

{% endblock %}